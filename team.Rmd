---
title: "Lab 4"
author: "Tyler Kruzan & Cameron Stocker"
date: "10/23/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Outline
We are using `dplyr` & `tidyr` to manipulate and clean a dataset with 2018 Iowa State Football statistics. This dataset includes stats collected from both sides of the ball, Offense & Defense for every game of the 2018 season as well as information regarding each player's background. To get more information about the players we will have use joins in order to get the data from the offense and defense data sets available to be be used with the biography data set. 

```{r,include=FALSE}
library(readxl)
defense <- read_excel('cyclonesFootball2018.xlsx', sheet='Defensive')
offense <- read_excel('cyclonesFootball2018.xlsx', sheet='Offensive')
bio <- read_excel('cyclonesFootball2018.xlsx', sheet='Biography')
library(tidyr)
library(dplyr)
library(ggplot2)
```


#Step 1: Cleaning
```{r}
offClean = offense %>%
  mutate(Name = as.factor(Name)) %>%
  mutate(Opponent_Opponent = as.factor(Opponent_Opponent))
defClean = defense %>%
  mutate(Name = as.factor(Name)) %>%
  mutate(Opponent_Opponent = as.factor(Opponent_Opponent))
bioClean = bio %>%
  mutate(Name = as.factor(Name))
defClean = mutate_at(defClean, names(defClean[,3:length(defClean)]), as.numeric)
offClean = mutate_at(offClean, names(offClean[,3:length(offClean)]), as.numeric)
bioClean = mutate_at(bioClean, "Weight", as.numeric)
bioClean = bioClean %>% separate("Height", sep = "-", into = c("Feet", "inches")) %>% mutate_at(c("Feet", "inches"), as.numeric) %>% mutate(Height = Feet*12 + inches) %>% select(-Feet,-inches)
str(defClean)
str(offClean)
str(bioClean)
```

#Step 2: Tidying the Clean Defense Data
```{r}
defClean = defClean %>%
  gather(key = Statistic, value = Total, 3:11)
defenseGroup =  defClean %>% group_by(Name, Statistic) %>% summarize(Total = sum(Total))
defenseGroup %>% 
  ggplot(aes(Total)) + geom_histogram(bins = 25) + facet_wrap(~Statistic)
```

Above you can see a plot of histograms with defensive data. As you can see above, Turnovers are significantly more rare. There are many players with just zero or even just one Interception, Forced Fumble, & Fumble Recovery. Whereas Solo Tackles and Tackles Assists have some players with up to the mid 50s. 


```{r}
defClean %>%
  filter(Statistic == "Tackles_Solo" & Opponent_Opponent == c("West Virginia","Kansas State")) %>%
  spread(key = Opponent_Opponent, value = Total) %>%
  ggplot(aes(x = "West Virginia", y = "Kansas State")) + geom_point()
```

Here are the first few rows from the City and State columns.

```{r}
bioClean = bioClean %>% separate("Hometown", sep = ", ", into = c("City", "State"))
bioClean %>% select(City, State) %>% head()
```

Here is a list of the number of players from each state.

```{r}
bioClean %>% group_by(State) %>% summarize(n=n())
```

#Step 3: Joining data frames

From the scatterplot below, it does not appear that weight has a relationship with the amount of receiving yards from a player.

```{r}
offBios = inner_join(bioClean, offense, by=c("Name","Opponent_Opponent"))
offBios %>% group_by(Weight) %>% summarize(Receiving_YDS = sum(Receiving_YDS)) %>% ggplot(aes(Weight, Receiving_YDS)) + geom_point()
```





